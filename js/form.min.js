import{i as E}from"./functions.min.js";document.querySelectorAll(".password__eye").forEach(t=>{t.addEventListener("click",()=>{const r=t.previousElementSibling,a=r.getAttribute("type")==="password";r.setAttribute("type",a?"text":"password"),t.classList.toggle("active",a)})});let c={getErrors(t){let r=0,a=t.querySelectorAll("[required]");return a.length&&a.forEach(e=>{(e.offsetParent!==null||e.tagName==="SELECT")&&!e.disabled&&(r+=this.validateInput(e))}),r},validateInput(t){let r=0;return t.type==="email"?(t.value=t.value.replace(" ",""),this.emailTest(t)?(this.addError(t),this.removeSuccess(t),r++):(this.removeError(t),this.addSuccess(t))):t.type==="checkbox"&&!t.checked?(this.addError(t),this.removeSuccess(t),r++):t.value.trim()?(this.removeError(t),this.addSuccess(t)):(this.addError(t),this.removeSuccess(t),r++),r},addError(t){t.classList.add("--form-error"),t.parentElement.classList.add("--form-error");let r=t.parentElement.querySelector("[data-fls-form-error]");r&&t.parentElement.removeChild(r),t.dataset.flsFormErrtext&&t.parentElement.insertAdjacentHTML("beforeend",`<div data-fls-form-error>${t.dataset.flsFormErrtext}</div>`)},removeError(t){t.classList.remove("--form-error"),t.parentElement.classList.remove("--form-error"),t.parentElement.querySelector("[data-fls-form-error]")&&t.parentElement.removeChild(t.parentElement.querySelector("[data-fls-form-error]"))},addSuccess(t){t.classList.add("--form-success"),t.parentElement.classList.add("--form-success")},removeSuccess(t){t.classList.remove("--form-success"),t.parentElement.classList.remove("--form-success")},formClean(t){t.reset(),setTimeout(()=>{let r=t.querySelectorAll("input,textarea");for(let e=0;e<r.length;e++){const l=r[e];l.parentElement.classList.remove("--form-focus"),l.classList.remove("--form-focus"),c.removeError(l)}let a=t.querySelectorAll('input[type="checkbox"]');if(a.length&&a.forEach(e=>{e.checked=!1}),window.flsSelect){let e=t.querySelectorAll("select[data-fls-select]");e.length&&e.forEach(l=>{window.flsSelect.selectBuild(l)})}},0)},emailTest(t){return!/^\w+([\.-]?\w+)*@\w+([\.-]?\w+)*(\.\w{2,8})+$/.test(t.value)}};function v(){function t(){const a=document.forms;if(a.length)for(const s of a)s.hasAttribute("data-fls-form-novalidate")||s.setAttribute("novalidate",!0),s.addEventListener("submit",function(o){const n=o.target;e(n,o)}),s.addEventListener("reset",function(o){const n=o.target;c.formClean(n)});async function e(s,o){if(c.getErrors(s)===0)if(s.dataset.flsForm==="ajax"){o.preventDefault();const i=s.getAttribute("action")?s.getAttribute("action").trim():"#",f=s.getAttribute("method")?s.getAttribute("method").trim():"GET",u=new FormData(s);s.classList.add("--sending");const d=await fetch(i,{method:f,body:u});if(d.ok){let p=await d.json();s.classList.remove("--sending"),l(s,p)}else s.classList.remove("--sending")}else s.dataset.flsForm==="dev"&&(o.preventDefault(),l(s));else if(o.preventDefault(),s.querySelector(".--form-error")&&s.hasAttribute("data-fls-form-gotoerr")){const i=s.dataset.flsFormGotoerr?s.dataset.flsFormGotoerr:".--form-error";E(i)}}function l(s,o=""){document.dispatchEvent(new CustomEvent("formSent",{detail:{form:s}})),setTimeout(()=>{if(window.flsPopup){const n=s.dataset.flsFormPopup;n&&window.flsPopup.open(n)}},0),c.formClean(s)}}function r(){document.body.addEventListener("focusin",function(a){const e=a.target;(e.tagName==="INPUT"||e.tagName==="TEXTAREA")&&(e.hasAttribute("data-fls-form-nofocus")||(e.classList.add("--form-focus"),e.parentElement.classList.add("--form-focus")),e.hasAttribute("data-fls-form-validatenow")&&c.removeError(e))}),document.body.addEventListener("focusout",function(a){const e=a.target;(e.tagName==="INPUT"||e.tagName==="TEXTAREA")&&(e.hasAttribute("data-fls-form-nofocus")||(e.classList.remove("--form-focus"),e.parentElement.classList.remove("--form-focus")),e.hasAttribute("data-fls-form-validatenow")&&c.validateInput(e))})}t(),r()}document.querySelector("[data-fls-form]")&&window.addEventListener("load",v);export{c as f};
