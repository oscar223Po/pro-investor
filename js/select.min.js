import{F as S,f as r,h as C}from"./functions.min.js";import{f as m}from"./_functions.min.js";class b{constructor(e,s=null){let t={init:!0,speed:150};if(this.config=Object.assign(t,e),this.selectClasses={classSelect:"select",classSelectBody:"select__body",classSelectTitle:"select__title",classSelectValue:"select__value",classSelectLabel:"select__label",classSelectInput:"select__input",classSelectText:"select__text",classSelectLink:"select__link",classSelectOptions:"select__options",classSelectOptionsScroll:"select__scroll",classSelectOption:"select__option",classSelectContent:"select__content",classSelectRow:"select__row",classSelectData:"select__asset",classSelectDisabled:"--select-disabled",classSelectTag:"--select-tag",classSelectOpen:"--select-open",classSelectActive:"--select-active",classSelectFocus:"--select-focus",classSelectMultiple:"--select-multiple",classSelectCheckBox:"--select-checkbox",classSelectOptionSelected:"--select-selected",classSelectPseudoLabel:"--select-pseudo-label"},this._this=this,this.config.init){const l=s?document.querySelectorAll(s):document.querySelectorAll("select[data-fls-select]");l.length&&(this.selectsInit(l),S("_FLS_SELECT_START",l.length))}}getSelectClass(e){return`.${e}`}getSelectElement(e,s){return{originalSelect:e.querySelector("select"),selectElement:e.querySelector(this.getSelectClass(s))}}selectsInit(e){e.forEach((s,t)=>{this.selectInit(s,t+1)}),document.addEventListener("click",(function(s){this.selectsActions(s)}).bind(this)),document.addEventListener("keydown",(function(s){this.selectsActions(s)}).bind(this)),document.addEventListener("focusin",(function(s){this.selectsActions(s)}).bind(this)),document.addEventListener("focusout",(function(s){this.selectsActions(s)}).bind(this))}selectInit(e,s){if(s&&(e.dataset.flsSelectId=s),e.options.length){const t=this;let l=document.createElement("div");l.classList.add(this.selectClasses.classSelect),e.parentNode.insertBefore(l,e),l.appendChild(e),e.hidden=!0,this.getSelectPlaceholder(e)&&(e.dataset.placeholder=this.getSelectPlaceholder(e).value,this.getSelectPlaceholder(e).label.show&&this.getSelectElement(l,this.selectClasses.classSelectTitle).selectElement.insertAdjacentHTML("afterbegin",`<span class="${this.selectClasses.classSelectLabel}">${this.getSelectPlaceholder(e).label.text?this.getSelectPlaceholder(e).label.text:this.getSelectPlaceholder(e).value}</span>`)),l.insertAdjacentHTML("beforeend",`<div class="${this.selectClasses.classSelectBody}"><div hidden class="${this.selectClasses.classSelectOptions}"></div></div>`),this.selectBuild(e),e.dataset.flsSelectSpeed=e.dataset.flsSelectSpeed?e.dataset.flsSelectSpeed:this.config.speed,this.config.speed=+e.dataset.flsSelectSpeed,e.addEventListener("change",function(c){t.selectChange(c)})}}selectBuild(e){const s=e.parentElement;e.id&&(s.id=e.id,e.removeAttribute("id")),s.dataset.flsSelectId=e.dataset.flsSelectId,e.dataset.flsSelectModif&&s.classList.add(`select--${e.dataset.flsSelectModif}`),e.multiple?s.classList.add(this.selectClasses.classSelectMultiple):s.classList.remove(this.selectClasses.classSelectMultiple),e.hasAttribute("data-fls-select-checkbox")&&e.multiple?s.classList.add(this.selectClasses.classSelectCheckBox):s.classList.remove(this.selectClasses.classSelectCheckBox),this.setSelectTitleValue(s,e),this.setOptions(s,e),e.hasAttribute("data-fls-select-search")&&this.searchActions(s),e.hasAttribute("data-fls-select-open")&&this.selectAction(s),this.selectDisabled(s,e)}selectsActions(e){const s=e.target,t=e.type,l=s.closest(this.getSelectClass(this.selectClasses.classSelect)),c=s.closest(this.getSelectClass(this.selectClasses.classSelectTag));if(!l&&!c)return this.selects\u0421lose();const a=l||document.querySelector(`.${this.selectClasses.classSelect}[data-fls-select-id="${c.dataset.flsSelectId}"]`),n=this.getSelectElement(a).originalSelect;if(!n.disabled)if(t==="click"){const i=s.closest(this.getSelectClass(this.selectClasses.classSelectTag)),o=s.closest(this.getSelectClass(this.selectClasses.classSelectTitle)),h=s.closest(this.getSelectClass(this.selectClasses.classSelectOption));if(i){const d=document.querySelector(`.${this.selectClasses.classSelect}[data-fls-select-id="${i.dataset.flsSelectId}"] .select__option[data-fls-select-value="${i.dataset.flsSelectValue}"]`);this.optionAction(a,n,d)}else o?this.selectAction(a):h&&this.optionAction(a,n,h)}else t==="focusin"||t==="focusout"?l&&a.classList.toggle(this.selectClasses.classSelectFocus,t==="focusin"):t==="keydown"&&e.code==="Escape"&&this.selects\u0421lose()}selects\u0421lose(e){const t=(e||document).querySelectorAll(`${this.getSelectClass(this.selectClasses.classSelect)}${this.getSelectClass(this.selectClasses.classSelectOpen)}`);t.length&&t.forEach(l=>{this.select\u0421lose(l)})}select\u0421lose(e){const s=this.getSelectElement(e).originalSelect,t=this.getSelectElement(e,this.selectClasses.classSelectOptions).selectElement;t.classList.contains("_slide")||(e.classList.remove(this.selectClasses.classSelectOpen),r(t,s.dataset.flsSelectSpeed),setTimeout(()=>{e.style.zIndex=""},s.dataset.flsSelectSpeed))}selectAction(e){const s=this.getSelectElement(e).originalSelect,t=this.getSelectElement(e,this.selectClasses.classSelectOptions).selectElement;t.querySelectorAll(`.${this.selectClasses.classSelectOption}`);const l=s.dataset.flsSelectZIndex?s.dataset.flsSelectZIndex:3;if(this.setOptionsPosition(e),s.closest("[data-fls-select-one]")){const c=s.closest("[data-fls-select-one]");this.selects\u0421lose(c)}setTimeout(()=>{t.classList.contains("--slide")||(e.classList.toggle(this.selectClasses.classSelectOpen),C(t,s.dataset.flsSelectSpeed),e.classList.contains(this.selectClasses.classSelectOpen)?e.style.zIndex=l:setTimeout(()=>{e.style.zIndex=""},s.dataset.flsSelectSpeed))},0)}setSelectTitleValue(e,s){const t=this.getSelectElement(e,this.selectClasses.classSelectBody).selectElement,l=this.getSelectElement(e,this.selectClasses.classSelectTitle).selectElement;l&&l.remove(),t.insertAdjacentHTML("afterbegin",this.getSelectTitleValue(e,s)),s.hasAttribute("data-fls-select-search")&&this.searchActions(e)}getSelectTitleValue(e,s){let t=this.getSelectedOptionsData(s,2).html;s.multiple&&s.hasAttribute("data-fls-select-tags")&&(t=this.getSelectedOptionsData(s).elements.map(a=>`<span role="button" data-fls-select-id="${e.dataset.flsSelectId}" data-fls-select-value="${a.value}" class="--select-tag">${this.getSelectElementContent(a)}</span>`).join(""),s.dataset.flsSelectTags&&document.querySelector(s.dataset.flsSelectTags)&&(document.querySelector(s.dataset.flsSelectTags).innerHTML=t,s.hasAttribute("data-fls-select-search")&&(t=!1))),t=t.length?t:s.dataset.flsSelectPlaceholder||"",s.hasAttribute("data-fls-select-tags")||(t=t?t.map(a=>a.replace(/"/g,"&quot;")):"");let l="",c="";if(s.hasAttribute("data-fls-select-pseudo-label")&&(l=s.dataset.flsSelectPseudoLabel?` data-fls-select-pseudo-label="${s.dataset.flsSelectPseudoLabel}"`:' data-fls-select-pseudo-label="\u0417\u0430\u043F\u043E\u0432\u043D\u0456\u0442\u044C \u0430\u0442\u0440\u0438\u0431\u0443\u0442"',c=` ${this.selectClasses.classSelectPseudoLabel}`),this.getSelectedOptionsData(s).values.length?e.classList.add(this.selectClasses.classSelectActive):e.classList.remove(this.selectClasses.classSelectActive),s.hasAttribute("data-fls-select-search"))return`<div class="${this.selectClasses.classSelectTitle}"><span${l} class="${this.selectClasses.classSelectValue}"><input autocomplete="off" type="text" placeholder="${t}" data-fls-select-placeholder="${t}" class="${this.selectClasses.classSelectInput}"></span></div>`;{const a=this.getSelectedOptionsData(s).elements.length&&this.getSelectedOptionsData(s).elements[0].dataset.flsSelectClass?` ${this.getSelectedOptionsData(s).elements[0].dataset.flsSelectClass}`:"";return`<button type="button" class="${this.selectClasses.classSelectTitle}"><span${l} class="${this.selectClasses.classSelectValue}${c}"><span class="${this.selectClasses.classSelectContent}${a}">${t}</span></span></button>`}}getSelectElementContent(e){const s=e.dataset.flsSelectAsset?`${e.dataset.flsSelectAsset}`:"",t=s.indexOf("img")>=0?`<img src="${s}" alt="">`:s;let l="";return l+=s?`<span class="${this.selectClasses.classSelectRow}">`:"",l+=s?`<span class="${this.selectClasses.classSelectData}">`:"",l+=s?t:"",l+=s?"</span>":"",l+=s?`<span class="${this.selectClasses.classSelectText}">`:"",l+=e.textContent,l+=s?"</span>":"",l+=s?"</span>":"",l}getSelectPlaceholder(e){const s=Array.from(e.options).find(t=>!t.value);if(s)return{value:s.textContent,show:s.hasAttribute("data-fls-select-show"),label:{show:s.hasAttribute("data-fls-select-label"),text:s.dataset.flsSelectLabel}}}getSelectedOptionsData(e,s){let t=[];return e.multiple?t=Array.from(e.options).filter(l=>l.value).filter(l=>l.selected):t.push(e.options[e.selectedIndex]),{elements:t.map(l=>l),values:t.filter(l=>l.value).map(l=>l.value),html:t.map(l=>this.getSelectElementContent(l))}}getOptions(e){const s=(e.hasAttribute("data-fls-select-scroll"),"");+e.dataset.flsSelectScroll&&+e.dataset.flsSelectScroll;let t=Array.from(e.options);if(t.length>0){let l="";return(this.getSelectPlaceholder(e)&&!this.getSelectPlaceholder(e).show||e.multiple)&&(t=t.filter(c=>c.value)),l+=`<div ${s}  class="${this.selectClasses.classSelectOptionsScroll}">`,t.forEach(c=>{l+=this.getOption(c,e)}),l+="</div>",l}}getOption(e,s){const t=e.selected&&s.multiple?` ${this.selectClasses.classSelectOptionSelected}`:"",l=e.selected&&!s.hasAttribute("data-fls-select-show-selected")&&!s.multiple?"hidden":"",c=e.dataset.flsSelectClass?` ${e.dataset.flsSelectClass}`:"",a=e.dataset.flsSelectHref?e.dataset.flsSelectHref:!1,n=e.hasAttribute("data-fls-select-href-blank")?'target="_blank"':"";let i="";return i+=a?`<a ${n} ${l} href="${a}" data-fls-select-value="${e.value}" class="${this.selectClasses.classSelectOption}${c}${t}">`:`<button ${l} class="${this.selectClasses.classSelectOption}${c}${t}" data-fls-select-value="${e.value}" type="button">`,i+=this.getSelectElementContent(e),i+=a?"</a>":"</button>",i}setOptions(e,s){const t=this.getSelectElement(e,this.selectClasses.classSelectOptions).selectElement;t.innerHTML=this.getOptions(s)}setOptionsPosition(e){const s=this.getSelectElement(e).originalSelect,t=this.getSelectElement(e,this.selectClasses.classSelectOptions).selectElement,l=this.getSelectElement(e,this.selectClasses.classSelectOptionsScroll).selectElement,c=+s.dataset.flsSelectScroll?`${+s.dataset.flsSelectScroll}px`:"",a=+s.dataset.flsSelectOptionsMargin?+s.dataset.flsSelectOptionsMargin:10;if(e.classList.contains(this.selectClasses.classSelectOpen))setTimeout(()=>{e.classList.remove("select--show-top"),l.style.maxHeight=c},+s.dataset.flsSelectSpeed);else{t.hidden=!1;const n=l.offsetHeight?l.offsetHeight:parseInt(window.getComputedStyle(l).getPropertyValue("max-height")),i=t.offsetHeight>n?t.offsetHeight:n+t.offsetHeight,o=i-n;t.hidden=!0;const h=e.offsetHeight,d=e.getBoundingClientRect().top,p=d+i+h+o,u=window.innerHeight-(p+a);if(u<0){const f=i+u;f<100?(e.classList.add("select--show-top"),l.style.maxHeight=d<i?`${d-(i-d)}px`:c):(e.classList.remove("select--show-top"),l.style.maxHeight=`${f}px`)}}}optionAction(e,s,t){if(!e.querySelector(this.getSelectClass(this.selectClasses.classSelectOptions)).classList.contains("--slide")){if(s.multiple){t.classList.toggle(this.selectClasses.classSelectOptionSelected);const c=this.getSelectedOptionsData(s).elements;for(const n of c)n.removeAttribute("selected");const a=e.querySelectorAll(this.getSelectClass(this.selectClasses.classSelectOptionSelected));for(const n of a){const i=n.dataset.flsSelectValue,o=s.querySelector(`option[value="${i}"]`);o&&o.setAttribute("selected","selected")}}else s.hasAttribute("data-fls-select-show-selected")||setTimeout(()=>{const c=e.querySelector(`${this.getSelectClass(this.selectClasses.classSelectOption)}[hidden]`);c&&(c.hidden=!1),t.hidden=!0},this.config.speed),s.value=t.dataset.flsSelectValue||t.textContent,this.selectAction(e);this.setSelectTitleValue(e,s),this.setSelectChange(s)}}selectChange(e){const s=e.target;this.selectBuild(s),this.setSelectChange(s)}setSelectChange(e){if(e.hasAttribute("data-fls-select-validate")&&m.validateInput(e),e.hasAttribute("data-fls-select-submit")&&e.value){let t=document.createElement("button");t.type="submit",e.closest("form").append(t),t.click(),t.remove()}const s=e.parentElement;this.selectCallback(s,e)}selectDisabled(e,s){s.disabled?(e.classList.add(this.selectClasses.classSelectDisabled),this.getSelectElement(e,this.selectClasses.classSelectTitle).selectElement.disabled=!0):(e.classList.remove(this.selectClasses.classSelectDisabled),this.getSelectElement(e,this.selectClasses.classSelectTitle).selectElement.disabled=!1)}searchActions(e){const s=this.getSelectElement(e,this.selectClasses.classSelectInput).selectElement,t=this.getSelectElement(e,this.selectClasses.classSelectOptions).selectElement;s.addEventListener("input",()=>{const l=s.value.toLowerCase();t.querySelectorAll(`.${this.selectClasses.classSelectOption}`).forEach(a=>{const n=a.textContent.toLowerCase();a.hidden=!n.includes(l)}),t.hidden&&this.selectAction(e)})}selectCallback(e,s){document.dispatchEvent(new CustomEvent("selectCallback",{detail:{select:s}}))}}document.querySelector("select[data-fls-select]")&&window.addEventListener("load",()=>window.flsSelect=new b({}));
